///--------------------------------------------------------------------------------------//	File:		RosterManager.h//	Project:	Jabbernaut////	Purpose:	<default>//	Created:	Thursday, 2000-05-18//	Authors:	MH - Max Horn <max@quendi.de>////	Copyright:	(c) 2000-2001 Max Horn <max@quendi.de>////	This program is free software; you can redistribute it and/or modify//	it under the terms of the GNU General Public License as published by//	the Free Software Foundation; either version 2 of the License, or//	(at your option) any later version.//	//	This program is distributed in the hope that it will be useful,//	but WITHOUT ANY WARRANTY; without even the implied warranty of//	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the//	GNU General Public License for more details.//	//	You should have received a copy of the GNU General Public License//	along with this program; if not, write to the Free Software//	Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA, or visit//	<http://www.gnu.org/copyleft/gpl.html> on the World Wide Web.///--------------------------------------------------------------------------------------#pragma once///- Includes ---------------------------------------------------------------------------#include	"ZObjectArray.h"#include	<string>#include	"BaseClient.h"#ifndef TOQ  #include	"RosterAddItemDialog.h"#endif#include	"ZHLRosterItem.h"///- Class forwards ---------------------------------------------------------------------namespace MacJLib {	class	JID;	class	MessageMsg;	class	PresenceMsg;	class	RosterItem;	class	RosterMsg;}using MacJLib::GroupList;using MacJLib::JID;using MacJLib::MessageMsg;using MacJLib::MsgListener;using MacJLib::PresenceMsg;using MacJLib::RosterItem;using MacJLib::RosterMsg;class	RosterDialog;class	ZHLFolder;class	ZHLRosterGroup;class	ZHLRosterSubItem;///- Constants --------------------------------------------------------------------------///- Globals ----------------------------------------------------------------------------///- Prototypes -------------------------------------------------------------------------///- Data Types -------------------------------------------------------------------------typedef ZObjectList		ZHLRosterItemList;typedef ZObjectList		ZHLGroupItemList;///- Class declaration ------------------------------------------------------------------#pragma mark RosterManagerclass RosterManager{	friend class	ZHLRosterItem;	friend class	ZHLRosterSubItem;#ifndef TOQ	friend void RosterAddItemDialog::ClickItem( const short theItem );#endif		class	RosterDispatcher : public MsgListener	{		void	onRoster( RosterMsg &inRoster )			{ RosterManager::OnRosterMsg( inRoster ); }		void	onPresence( PresenceMsg &inPresence )	{ RosterManager::OnPresenceMsg( inPresence ); }	};		//ÊStatic Data	protected:		static RosterDialog			*msRosterDialog;		static ZHLFolder			*msZHLRootFolder;		static ZHLRosterItemList	*msZHLRosterItems;		static ZHLGroupItemList		*msZHLGroupItems;		#ifdef TOQ		static std::string			msCurrentGroupName;#else		static ZHLRosterGroup		*msMetaGroupOnline;		static ZHLRosterGroup		*msMetaGroupMyResources;		static ZHLRosterGroup		*msMetaGroupOffline;		static ZHLRosterGroup		*msMetaGroupPending;		static ZHLRosterGroup		*msMetaGroupStalkers;		static ZHLRosterGroup		*msMetaGroupAgents;#endif				static CIconHandle			msPresenceCicns[kLastPresenceStatus];				static bool					msRosterTransfered;			// Static Methods	public:		static void					Init();		static void					Deinit();				static void					DoAddRosterItem( const MacJLib::JID & aJID = MacJLib::emptyJID );		static void					DoSelectRosterDialog();				static void					OnRosterMsg( const RosterMsg &aMsg );		static void					OnPresenceMsg( const PresenceMsg &inPresence );		static void					OnLogin();		static void					OnLogout();				static bool					IsRosterTransfered()	{ return msRosterTransfered; }				static bool					IsOnRoster( const JID &inJID, bool strictMatch = false );		static bool					IsSubscribedTo( const JID &inJID );		static std::string			CompleteJID( const JID &inJID );		static std::string			GetRosterNick( const JID &inJID );				static void					DrawPresenceIcon( const PresenceStatus which, const Point where );				static ZHLRosterItem*		FindZHLRosterItem( const JID &inJID, bool strictMatch = false );				// FIX ME - hide these funcs somehow!		static void					NotifyPrefChange();		static void					SortRoster();		#ifdef TOQ		static void					SetCurrentGroupName( const std::string &group );		static void					SetRosterDialogTitle( const std::string &title );		static void					SetRosterStatusPopup( long value );		static void					AddFakeRosterItem( const MessageMsg &inMessage );#endif				static void					CheckMetaGroups();		static void					ShowHideMetaGroups();				static void					GetGroupList( GroupList &outList );			protected:		static void					SendRosterQuery();				static void					OnRosterItem( const RosterItem &inItem, bool strictMatch = false );		static void					SendRosterItem( const RosterItem &inItem );				static void					AddToGroups( ZHLRosterItem &inItem );		static void					RemoveFromGroups( ZHLRosterItem &inItem );		static void					RefreshRosterItem( ZHLRosterItem &inItem );		static ZHLRosterGroup*		FindOrCreateGroupWithName( const std::string &name, MetaGroup inMetaGroup );				static ZHLFolder*			GetMetaFolder( MetaGroup inMetaGroup );		static bool					IsMetaFolderOpen( MetaGroup inMetaGroup );				static void					ResetRootFolder();};